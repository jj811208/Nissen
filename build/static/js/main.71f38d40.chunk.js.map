{"version":3,"sources":["logo.svg","music/lemon.mid","components/PitchDetector/piano/A0.wav","components/PitchDetector/piano/A1.wav","components/PitchDetector/piano/A2.wav","components/PitchDetector/piano/A3.wav","components/PitchDetector/piano/A4.wav","components/PitchDetector/piano/A5.wav","components/PitchDetector/piano/A6.wav","components/PitchDetector/piano/As0.wav","components/PitchDetector/piano/As1.wav","components/PitchDetector/piano/As2.wav","components/PitchDetector/piano/As3.wav","components/PitchDetector/piano/As4.wav","components/PitchDetector/piano/As5.wav","components/PitchDetector/piano/As6.wav","components/PitchDetector/piano/B0.wav","components/PitchDetector/piano/B1.wav","components/PitchDetector/piano/B2.wav","components/PitchDetector/piano/B3.wav","components/PitchDetector/piano/B4.wav","components/PitchDetector/piano/B5.wav","components/PitchDetector/piano/B6.wav","components/PitchDetector/piano/C0.wav","components/PitchDetector/piano/C1.wav","components/PitchDetector/piano/C2.wav","components/PitchDetector/piano/C3.wav","components/PitchDetector/piano/C4.wav","components/PitchDetector/piano/C5.wav","components/PitchDetector/piano/C6.wav","components/PitchDetector/piano/Cs0.wav","components/PitchDetector/piano/Cs1.wav","components/PitchDetector/piano/Cs2.wav","components/PitchDetector/piano/Cs3.wav","components/PitchDetector/piano/Cs4.wav","components/PitchDetector/piano/Cs5.wav","components/PitchDetector/piano/Cs6.wav","components/PitchDetector/piano/D0.wav","components/PitchDetector/piano/D1.wav","components/PitchDetector/piano/D2.wav","components/PitchDetector/piano/D3.wav","components/PitchDetector/piano/D4.wav","components/PitchDetector/piano/D5.wav","components/PitchDetector/piano/D6.wav","components/PitchDetector/piano/Ds0.wav","components/PitchDetector/piano/Ds1.wav","components/PitchDetector/piano/Ds2.wav","components/PitchDetector/piano/Ds3.wav","components/PitchDetector/piano/Ds4.wav","components/PitchDetector/piano/Ds5.wav","components/PitchDetector/piano/Ds6.wav","components/PitchDetector/piano/E0.wav","components/PitchDetector/piano/E1.wav","components/PitchDetector/piano/E2.wav","components/PitchDetector/piano/E3.wav","components/PitchDetector/piano/E4.wav","components/PitchDetector/piano/E5.wav","components/PitchDetector/piano/E6.wav","components/PitchDetector/piano/F0.wav","components/PitchDetector/piano/F1.wav","components/PitchDetector/piano/F2.wav","components/PitchDetector/piano/F3.wav","components/PitchDetector/piano/F4.wav","components/PitchDetector/piano/F5.wav","components/PitchDetector/piano/F6.wav","components/PitchDetector/piano/Fs0.wav","components/PitchDetector/piano/Fs1.wav","components/PitchDetector/piano/Fs2.wav","components/PitchDetector/piano/Fs3.wav","components/PitchDetector/piano/Fs4.wav","components/PitchDetector/piano/Fs5.wav","components/PitchDetector/piano/Fs6.wav","components/PitchDetector/piano/G0.wav","components/PitchDetector/piano/G1.wav","components/PitchDetector/piano/G2.wav","components/PitchDetector/piano/G3.wav","components/PitchDetector/piano/G4.wav","components/PitchDetector/piano/G5.wav","components/PitchDetector/piano/G6.wav","components/PitchDetector/piano/Gs0.wav","components/PitchDetector/piano/Gs1.wav","components/PitchDetector/piano/Gs2.wav","components/PitchDetector/piano/Gs3.wav","components/PitchDetector/piano/Gs4.wav","components/PitchDetector/piano/Gs5.wav","components/PitchDetector/piano/Gs6.wav","components/PitchDetector/mapPitch.js","components/PitchDetector/amdfDetector.js","components/PitchDetector/pitch.util.js","components/PitchDetector/PitchDetector.jsx","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","mapPitch","A0","A1","A2","A3","A4","A5","A6","A#0","As0","A#1","As1","A#2","As2","A#3","As3","A#4","As4","A#5","As5","A#6","As6","B0","B1","B2","B3","B4","B5","B6","C0","C1","C2","C3","C4","C5","C6","C#0","Cs0","C#1","Cs1","C#2","Cs2","C#3","Cs3","C#4","Cs4","C#5","Cs5","C#6","Cs6","D0","D1","D2","D3","D4","D5","D6","D#0","Ds0","D#1","Ds1","D#2","Ds2","D#3","Ds3","D#4","Ds4","D#5","Ds5","D#6","Ds6","E0","E1","E2","E3","E4","E5","E6","F0","F1","F2","F3","F4","F5","F6","F#0","Fs0","F#1","Fs1","F#2","Fs2","F#3","Fs3","F#4","Fs4","F#5","Fs5","F#6","Fs6","G0","G1","G2","G3","G4","G5","G6","G#0","Gs0","G#1","Gs1","G#2","Gs2","G#3","Gs3","G#4","Gs4","G#5","Gs5","G#6","Gs6","Amdf","config","arguments","length","undefined","sampleRate","minFrequency","maxFrequency","sensitivity","ratio","amd","maxPeriod","Math","ceil","minPeriod","floor","float32AudioBuffer","frames1","frames2","calcSub","i","j","u","aux1","aux2","maxShift","t","minval","Infinity","maxval","frameLength","summation","abs","cutoff","round","search_length","minpos","noteStrings","scaleStrings","noteFromPitch","frequency","noteNum","log","keyFromNote","note","requestAnimationFrame","window","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","synth","Tone","Sampler","console","toMaster","PitchDetector","props","_useState","useState","_useState2","Object","slicedToArray","pitch","setPitch","pitch2","useRef","tempPitch2","_useState3","forceUpdate","_useState5","_useState6","setNote","_useState7","_useState8","isRecord","setIsRecord","isCatchVoice","allVoice","allVoiceArray","audioContext","analyser","rafID","buf","Float32Array","AMDFDetector","useMemo","playTheCatchVoice","catchedVoice","voiceCat","diffPitchCount","targetPitchNumber","PitchKeepSecond","time","push","sec","count","newCat","prevCount","forEach","v","allTime","now","triggerAttackRelease","updatePitch","current","getFloatTimeDomainData","ac","myNote","util","myPitch","Date","getTime","getPitch","error","myNote2","myPitch2","openMicStyle","display","cursor","border","borderRadius","padding","openCatchStyle","marginTop","react_default","a","createElement","Fragment","onClick","dictionary","callback","handleError","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","e","alert","audio","mandatory","googEchoCancellation","googAutoGainControl","googNoiseSuppression","googHighpassFilter","googNoiseSuppression2","googEchoCancellation2","googAutoGainControl2","optional","stream","mediaStreamSource","createMediaStreamSource","ml5","pitchDetection","createAnalyser","connect","style","App","_React$useState","React","_React$useState2","myMidi","setMyMidi","useEffect","MIDI","fromUrl","kissTheRain","then","x","className","src","logo","alt","components_PitchDetector_PitchDetector","tracks","track","Promise","solve","notes","name","duration","velocity","type","Boolean","location","hostname","match","ReactDOM","render","src_App","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"gFAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,mDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,mDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,w3DC+KzBC,GAtFE,CACjBC,OACAC,OACAC,OACAC,OACAC,OACAC,OACAC,OACAC,MAAMC,IACNC,MAAMC,IACNC,MAAMC,IACNC,MAAMC,IACNC,MAAMC,IACNC,MAAMC,IACNC,MAAMC,IACNC,OACAC,OACAC,OACAC,OACAC,OACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,QACAC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,KACNC,MAAMC,MCzFSC,GAnFF,WAAiB,IAAhBC,EAAgBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,GAOfG,EAAaJ,EAAOI,YAFE,MAGtBC,EAAeL,EAAOK,cAPE,GAQxBC,EAAeN,EAAOM,cAPE,IAQxBC,EAAcP,EAAOO,aANC,GAOtBC,EAAQR,EAAOQ,OARC,EAShBC,EAAM,GAMNC,EAAYC,KAAKC,KAAKR,EAAaC,GACnCQ,EAAYF,KAAKG,MAAMV,EAAaE,GAE1C,OAAO,SAAsBS,GAC3B,IAKIC,EAASC,EAASC,EAASC,EAAGC,EAAGC,EAAGC,EAAMC,EALxCC,EAAWT,EAAmBb,OAEhCuB,EAAI,EACJC,EAASC,IACTC,GAAS,IAIb,IAAKT,EAAI,EAAGA,EAAIK,EAAUL,IACxB,GAAIN,GAAaM,GAAKA,GAAKT,EAAW,CACpC,IACEY,EAAO,EAAGC,EAAOJ,EAAGM,EAAI,EAAGT,EAAU,GAAIC,EAAU,GACnDK,EAAOE,EAAWL,EAClBM,IAAKF,IAAQD,IAEbN,EAAQS,GAAKV,EAAmBO,GAChCL,EAAQQ,GAAKV,EAAmBQ,GAIlC,IAAMM,EAAcb,EAAQd,OAE5B,IADAgB,EAAU,GACLG,EAAI,EAAGA,EAAIQ,EAAaR,IAC3BH,EAAQG,GAAKL,EAAQK,GAAKJ,EAAQI,GAIpC,IAAIS,EAAY,EAChB,IAAKT,EAAI,EAAGA,EAAIQ,EAAaR,IAC3BS,GAAanB,KAAKoB,IAAIb,EAAQG,IAEhCZ,EAAIU,GAAKW,EAIb,IAAKV,EAAIP,EAAWO,EAAIV,EAAWU,IAC7BX,EAAIW,GAAKM,IAAQA,EAASjB,EAAIW,IAC9BX,EAAIW,GAAKQ,IAAQA,EAASnB,EAAIW,IAGpC,IAAMY,EAASrB,KAAKsB,MAAM1B,GAAeqB,EAASF,GAAUA,GAC5D,IAAKN,EAAIP,EAAWO,GAAKV,GAAaD,EAAIW,GAAKY,EAAQZ,KAEvD,IAAMc,EAAgBrB,EAAY,EAClCa,EAASjB,EAAIW,GACb,IAAIe,EAASf,EACb,IAAKD,EAAIC,EAAI,EAAGD,EAAIC,EAAIc,GAAiBf,GAAKT,EAAWS,IACnDV,EAAIU,GAAKO,IACXA,EAASjB,EAAIU,GACbgB,EAAShB,GAIb,OAAIR,KAAKsB,MAAMxB,EAAI0B,GAAU3B,GAASoB,EAC7BxB,EAAa+B,EAEb,OCzDPC,GAAc,CAClB,IACA,KACA,IACA,KACA,IACA,IACA,KACA,IACA,KACA,IACA,KACA,KAEIC,GAAe,CACnB,uCACA,iCACA,2BACA,IACA,IACA,IACA,IACA,IACA,2BACA,iCACA,wCAiBIC,GAAgB,SAAAC,GACpB,IAAIC,EAAgB7B,KAAK8B,IAAIF,EAAY,KAAO5B,KAAK8B,IAAI,GAA3C,GACd,OAAO9B,KAAKsB,MAAMO,GAAW,IAiBzBE,GAAc,SAAAC,GAClB,OAAGA,EAAK,GAAKA,EAAK,IACXP,GAAYO,EAAO,IAAMN,GAAa1B,KAAKG,MAAM6B,EAAO,KACnD,0BC3ERC,GACJC,OAAOD,uBACPC,OAAOC,0BACPD,OAAOE,6BACPF,OAAOG,wBAEHC,GACJJ,OAAOI,sBAAwBJ,OAAOK,wBAExCL,OAAOM,aAAeN,OAAOM,cAAgBN,OAAOO,mBAEpD,IAAMC,GAAQ,IAAIC,IAAKC,QAAQhL,GAAU,WACvCiL,QAAQf,IAAI,QACXgB,WAiOYC,GA/NO,SAAAC,GAAS,IAAAC,EACHC,mBAAS,KADNC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GACtBK,EADsBH,EAAA,GACfI,EADeJ,EAAA,GAEvBK,EAASC,iBAAO,MAChBC,EAAaD,iBAAO,KAHGE,EAILT,mBAAS,MAAxBU,EAJoBR,OAAAC,EAAA,EAAAD,CAAAO,EAAA,MAAAE,EAKLX,mBAAS,KALJY,EAAAV,OAAAC,EAAA,EAAAD,CAAAS,EAAA,GAKtB7B,EALsB8B,EAAA,GAKhBC,EALgBD,EAAA,GAAAE,EAMGd,oBAAS,GANZe,EAAAb,OAAAC,EAAA,EAAAD,CAAAY,EAAA,GAMtBE,EANsBD,EAAA,GAMZE,EANYF,EAAA,GAOvBG,EAAeX,kBAAO,GACtBY,EAAWZ,iBAAO,IAClBa,EAAgBb,iBAAO,IACvBc,EAAed,iBAAO,IAAIjB,cAC1BgC,EAAWf,iBAAO,MAClBgB,EAAQhB,iBAAO,MACfiB,EAAMjB,iBAAO,IAAIkB,aAAa,OAC9BC,EAAeC,kBAAQzF,GAAM,IAuE7B0F,EAAoB,SAAAC,GAIxB,IAHA,IAAIC,EAAW,GAGNxE,EAAI,EAAGA,EAAIuE,EAAaxF,OAAQiB,IAAK,CAE5C,IADA,IAAIyE,EAAiB,EACZxE,EAAID,EAAI,EAAGC,EAAIsE,EAAaxF,SAC/BwF,EAAavE,GAAG8C,QAAUyB,EAAatE,GAAG6C,OAC5C2B,MAEEA,GARc,IAIyBxE,KAO7C,IAAIyE,EACFzE,EAAIwE,GAAkBF,EAAaxF,OAAS,EACxCkB,EAAIwE,EACJF,EAAaxF,OAAS,EAGxB4F,GACDJ,EAAaG,GAAmBE,KAAOL,EAAavE,GAAG4E,MAAQ,IAElEJ,EAASK,KAAK,CACZ/B,MAAOyB,EAAavE,GAAG8C,MACvBgC,IAAKH,EACLI,MAAOL,EAAoB1E,IAG7BA,EAAI0E,EAEN,IAAMM,EAAS,GACXC,EAAY,EAChBT,EAASU,QAAQ,SAACC,EAAGnF,GACfmF,EAAEJ,MA/Bc,EAiCd/E,IADJiF,EACoB,IAClBD,EAAOhF,EAAIiF,GAAWH,KAAOK,EAAEL,IAC/BE,EAAOhF,EAAIiF,GAAWF,OAASI,EAAEJ,OAGnCC,EAAOH,KAAK,CAAE/B,MAAOqC,EAAErC,MAAOgC,IAAKK,EAAEL,IAAKC,MAAOI,EAAEJ,UAGvD1C,QAAQf,IAAI0D,GAEZ,IAAII,EAAU,EACRC,EAAMlD,IAAKkD,MAAQ,EACzBL,EAAOE,QAAQ,SAACC,EAAGnF,GACjBkC,GAAMoD,qBAAqBH,EAAErC,MAAOqC,EAAEL,IAAKM,EAAUC,GACrDD,GAAWD,EAAEL,OAIXS,EAAc,SAAdA,IACJvB,EAASwB,QAAQC,uBAAuBvB,EAAIsB,SAC5C,IAAME,EAAKtB,EAAaF,EAAIsB,SACtBG,EAASC,GAAmBF,GAAM,GAClCG,EAAUD,GAAiBD,GACXA,EAAS,IAAMA,EAAS,IAG5CpC,EAAQ,KACRR,EAAS,OAETQ,EAAQoC,GACR5C,EAAS8C,GAELjC,EAAa4B,UACf1B,EAAc0B,QAAQX,KAAK,CACzB/B,MAAO+C,EACPjB,MAAM,IAAIkB,MAAOC,YAEnBlC,EAAS2B,QAAQK,GAAahC,EAAS2B,QAAQK,GAC3ChC,EAAS2B,QAAQK,GAAW,EAC5B,IAIR5B,EAAMuB,QAAU/D,GAAsB8D,GAEtCvC,EAAOwC,QAAQQ,SAAS,SAACC,EAAO7E,GAC9B,GAAI6E,EACF5D,QAAQ4D,MAAMA,OACT,CAIL,IAAMC,EAAUN,GAAmBxE,GAAa,GAC1C+E,EAAWP,GAAiBM,GAEhChD,EAAWsC,QADI,OAAbW,EACmBA,EAEA,IAGzB/C,OAIEgD,EAAe/B,kBACnB,iBAAO,CACLgC,QAAS,eACTC,OAAQ,UACRC,OAAQ,iBACRC,aAAc,MACdC,QAAS,YAEX,IAGIC,EAAiBrC,kBACrB,iBAAO,CACLgC,QAAS,eACTC,OAAQ,UACRC,OAAQ,iBACRC,aAAc,MACdC,QAAS,UACTE,UAAW,QAEb,IAEF,OACEC,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACEH,EAAAC,EAAAC,cAAA,OAAKE,QAhMe,WACA,OAAlB/C,EAAMuB,QACJ9B,GACF5B,GAAqBmC,EAAMuB,SAC3B7B,GAAY,KAEZ4B,IACA5B,GAAY,IDwCC,SAACsD,EAAYC,EAAUC,GAC1C,IACEC,UAAUC,aACRD,UAAUC,cACVD,UAAUE,oBACVF,UAAUG,gBACZH,UAAUC,aAAaJ,EAAYC,EAAUC,GAC7C,MAAOK,GACPC,MAAM,iCAAmCD,ICHvC5B,CA1C0B,CACxB8B,MAAO,CACLC,UAAW,CAKTC,sBAAsB,EACtBC,qBAAqB,EACrBC,sBAAsB,EACtBC,oBAAoB,EACpBC,uBAAuB,EACvBC,uBAAuB,EACvBC,sBAAsB,GAExBC,SAAU,KAGI,SAAAC,GAChB,IAAMC,EAAoBtE,EAAayB,QAAQ8C,wBAC7CF,GAIFpF,EAAOwC,QAAU+C,KAAIC,eAnE3B,sFAqEQzE,EAAayB,QACb4C,EACA,WACE/F,QAAQf,IAAI,UAIhB0C,EAASwB,QAAUzB,EAAayB,QAAQiD,iBACxCJ,EAAkBK,QAAQ1E,EAASwB,SACnC7B,GAAY,GACZ4B,IACAlD,QAAQf,IAAI,MAEM,WAClBmG,MAAM,+BA8IuBkB,MAAOvC,GACnC1C,EAAW,iCAAU,kCAExBkD,EAAAC,EAAAC,cAAA,OAAKE,QA3IgB,WACnBpD,EAAa4B,SACflB,EAAkBR,EAAc0B,SAChC3B,EAAS2B,QAAU,GACnB1B,EAAc0B,QAAU,GACxB5B,EAAa4B,SAAU,EACvBjC,EAAQ,OAERK,EAAa4B,SAAU,EACvBjC,EAAQ,OAkIwBoF,MAAOjC,GACpC9C,EAAa4B,QAAU,mBAAW,8CAErCoB,EAAAC,EAAAC,cAAA,uBAAepD,EAAW,OAAS,SACnCkD,EAAAC,EAAAC,cAAA,2BAAmBlD,EAAa4B,QAAU,OAAS,SACnDoB,EAAAC,EAAAC,cAAA,mBAAWtF,GACXoF,EAAAC,EAAAC,cAAA,wDAAkBhE,GAClB8D,EAAAC,EAAAC,cAAA,wDAAkB5D,EAAWsC,WC9LpBoD,OA7Cf,WAAe,IAAAC,EACeC,IAAMpG,SAAS,MAD9BqG,EAAAnG,OAAAC,EAAA,EAAAD,CAAAiG,EAAA,GACNG,EADMD,EAAA,GACEE,EADFF,EAAA,GAQb,OANAD,IAAMI,UAAU,WACdC,IAAKC,QAAQC,KAAaC,KAAK,SAAAC,GAC7BN,EAAUM,GACVlH,QAAQf,IAAI,UAEb,IAEDsF,EAAAC,EAAAC,cAAA,OAAK0C,UAAU,OACb5C,EAAAC,EAAAC,cAAA,UAAQ0C,UAAU,cAChB5C,EAAAC,EAAAC,cAAA,OAAK2C,IAAKC,IAAMF,UAAU,WAAWG,IAAI,SACzC/C,EAAAC,EAAAC,cAAC8C,GAAD,OAEFhD,EAAAC,EAAAC,cAAA,UACEE,QAAS,WACP3E,QAAQf,IAAI0H,GACZ,IAAM3D,EAAMlD,IAAKkD,MAAQ,IACzBhD,QAAQf,IAAI+D,GACZ2D,EAAOa,OAAO3E,QAAQ,SAAA4E,GACpB,IAAI5H,EAAQ,KACZ,IAAI6H,QAAQ,SAAAC,GACV9H,EAAQ,IAAIC,IAAKC,QAAQhL,GAAU,WACjC4S,MACC1H,aACFgH,KAAK,WACNQ,EAAMG,MAAM/E,QAAQ,SAAA1D,GAClBU,EAAMoD,qBACJ9D,EAAK0I,KACL1I,EAAK2I,SACL3I,EAAKoD,KAAOS,EACZ7D,EAAK4I,iBAMfC,KAAK,UAvBP,WCXcC,QACW,cAA7B5I,OAAO6I,SAASC,UAEe,UAA7B9I,OAAO6I,SAASC,UAEhB9I,OAAO6I,SAASC,SAASC,MACvB,2DCZNC,IAASC,OAAO/D,EAAAC,EAAAC,cAAC8D,GAAD,MAASC,SAASC,eAAe,SD2H3C,kBAAmB1D,WACrBA,UAAU2D,cAAcC,MAAM1B,KAAK,SAAA2B,GACjCA,EAAaC","file":"static/js/main.71f38d40.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/lemon.5ace125f.mid\";","module.exports = __webpack_public_path__ + \"static/media/A0.55bad57e.wav\";","module.exports = __webpack_public_path__ + \"static/media/A1.e6665d28.wav\";","module.exports = __webpack_public_path__ + \"static/media/A2.ffae8348.wav\";","module.exports = __webpack_public_path__ + \"static/media/A3.da6a8aa5.wav\";","module.exports = __webpack_public_path__ + \"static/media/A4.d73cabf6.wav\";","module.exports = __webpack_public_path__ + \"static/media/A5.37655296.wav\";","module.exports = __webpack_public_path__ + \"static/media/A6.9e62a1d1.wav\";","module.exports = __webpack_public_path__ + \"static/media/As0.43185359.wav\";","module.exports = __webpack_public_path__ + \"static/media/As1.6d0a31ab.wav\";","module.exports = __webpack_public_path__ + \"static/media/As2.775f7d0c.wav\";","module.exports = __webpack_public_path__ + \"static/media/As3.4d882a00.wav\";","module.exports = __webpack_public_path__ + \"static/media/As4.a598d864.wav\";","module.exports = __webpack_public_path__ + \"static/media/As5.b36a3b4f.wav\";","module.exports = __webpack_public_path__ + \"static/media/As6.a0e61679.wav\";","module.exports = __webpack_public_path__ + \"static/media/B0.a1cb8b82.wav\";","module.exports = __webpack_public_path__ + \"static/media/B1.a306b1aa.wav\";","module.exports = __webpack_public_path__ + \"static/media/B2.d779f678.wav\";","module.exports = __webpack_public_path__ + \"static/media/B3.8f63bb62.wav\";","module.exports = __webpack_public_path__ + \"static/media/B4.2f51ebf5.wav\";","module.exports = __webpack_public_path__ + \"static/media/B5.ad696f7f.wav\";","module.exports = __webpack_public_path__ + \"static/media/B6.0159fbf4.wav\";","module.exports = __webpack_public_path__ + \"static/media/C0.b7c2f2c1.wav\";","module.exports = __webpack_public_path__ + \"static/media/C1.35518a7d.wav\";","module.exports = __webpack_public_path__ + \"static/media/C2.dda39adc.wav\";","module.exports = __webpack_public_path__ + \"static/media/C3.0be5311b.wav\";","module.exports = __webpack_public_path__ + \"static/media/C4.1dfeaa09.wav\";","module.exports = __webpack_public_path__ + \"static/media/C5.8f711432.wav\";","module.exports = __webpack_public_path__ + \"static/media/C6.203f5eb7.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs0.a7648be8.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs1.99ecb003.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs2.1f7f4dd9.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs3.fc385203.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs4.bab03f8c.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs5.95ae7cd6.wav\";","module.exports = __webpack_public_path__ + \"static/media/Cs6.1412a54d.wav\";","module.exports = __webpack_public_path__ + \"static/media/D0.95ecedd2.wav\";","module.exports = __webpack_public_path__ + \"static/media/D1.4c24fb28.wav\";","module.exports = __webpack_public_path__ + \"static/media/D2.5bea68b7.wav\";","module.exports = __webpack_public_path__ + \"static/media/D3.6247322f.wav\";","module.exports = __webpack_public_path__ + \"static/media/D4.bd35c19d.wav\";","module.exports = __webpack_public_path__ + \"static/media/D5.8856b898.wav\";","module.exports = __webpack_public_path__ + \"static/media/D6.e926b007.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds0.cd6a0599.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds1.2d001db1.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds2.bb27efb1.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds3.b3f1b57d.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds4.2716ade6.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds5.2958c5ca.wav\";","module.exports = __webpack_public_path__ + \"static/media/Ds6.0306d567.wav\";","module.exports = __webpack_public_path__ + \"static/media/E0.31dfb23f.wav\";","module.exports = __webpack_public_path__ + \"static/media/E1.bb5c2154.wav\";","module.exports = __webpack_public_path__ + \"static/media/E2.ddc00192.wav\";","module.exports = __webpack_public_path__ + \"static/media/E3.c700eea2.wav\";","module.exports = __webpack_public_path__ + \"static/media/E4.2cc96930.wav\";","module.exports = __webpack_public_path__ + \"static/media/E5.8e3475a3.wav\";","module.exports = __webpack_public_path__ + \"static/media/E6.913120da.wav\";","module.exports = __webpack_public_path__ + \"static/media/F0.51c1291b.wav\";","module.exports = __webpack_public_path__ + \"static/media/F1.8de627a7.wav\";","module.exports = __webpack_public_path__ + \"static/media/F2.d5718aae.wav\";","module.exports = __webpack_public_path__ + \"static/media/F3.a8f31c25.wav\";","module.exports = __webpack_public_path__ + \"static/media/F4.8a38f56e.wav\";","module.exports = __webpack_public_path__ + \"static/media/F5.7948d726.wav\";","module.exports = __webpack_public_path__ + \"static/media/F6.0715ffe3.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs0.3cc0f455.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs1.6752efe9.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs2.848d9637.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs3.02ef6da4.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs4.06299bfb.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs5.a97772fe.wav\";","module.exports = __webpack_public_path__ + \"static/media/Fs6.4e8fa579.wav\";","module.exports = __webpack_public_path__ + \"static/media/G0.9afa156a.wav\";","module.exports = __webpack_public_path__ + \"static/media/G1.777d423a.wav\";","module.exports = __webpack_public_path__ + \"static/media/G2.cf52d708.wav\";","module.exports = __webpack_public_path__ + \"static/media/G3.146a244a.wav\";","module.exports = __webpack_public_path__ + \"static/media/G4.151cf8d0.wav\";","module.exports = __webpack_public_path__ + \"static/media/G5.f6ec5736.wav\";","module.exports = __webpack_public_path__ + \"static/media/G6.1251326d.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs0.451faa2d.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs1.500fb460.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs2.36ae9a32.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs3.c3d31c76.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs4.c9f62960.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs5.88550874.wav\";","module.exports = __webpack_public_path__ + \"static/media/Gs6.c867a170.wav\";","import A0 from './piano/A0.wav';\nimport A1 from './piano/A1.wav';\nimport A2 from './piano/A2.wav';\nimport A3 from './piano/A3.wav';\nimport A4 from './piano/A4.wav';\nimport A5 from './piano/A5.wav';\nimport A6 from './piano/A6.wav';\n\nimport As0 from './piano/As0.wav';\nimport As1 from './piano/As1.wav';\nimport As2 from './piano/As2.wav';\nimport As3 from './piano/As3.wav';\nimport As4 from './piano/As4.wav';\nimport As5 from './piano/As5.wav';\nimport As6 from './piano/As6.wav';\n\nimport B0 from './piano/B0.wav';\nimport B1 from './piano/B1.wav';\nimport B2 from './piano/B2.wav';\nimport B3 from './piano/B3.wav';\nimport B4 from './piano/B4.wav';\nimport B5 from './piano/B5.wav';\nimport B6 from './piano/B6.wav';\n\nimport C0 from './piano/C0.wav';\nimport C1 from './piano/C1.wav';\nimport C2 from './piano/C2.wav';\nimport C3 from './piano/C3.wav';\nimport C4 from './piano/C4.wav';\nimport C5 from './piano/C5.wav';\nimport C6 from './piano/C6.wav';\n\nimport Cs0 from './piano/Cs0.wav';\nimport Cs1 from './piano/Cs1.wav';\nimport Cs2 from './piano/Cs2.wav';\nimport Cs3 from './piano/Cs3.wav';\nimport Cs4 from './piano/Cs4.wav';\nimport Cs5 from './piano/Cs5.wav';\nimport Cs6 from './piano/Cs6.wav';\nimport D0 from './piano/D0.wav';\nimport D1 from './piano/D1.wav';\nimport D2 from './piano/D2.wav';\nimport D3 from './piano/D3.wav';\nimport D4 from './piano/D4.wav';\nimport D5 from './piano/D5.wav';\nimport D6 from './piano/D6.wav';\nimport Ds0 from './piano/Ds0.wav';\nimport Ds1 from './piano/Ds1.wav';\nimport Ds2 from './piano/Ds2.wav';\nimport Ds3 from './piano/Ds3.wav';\nimport Ds4 from './piano/Ds4.wav';\nimport Ds5 from './piano/Ds5.wav';\nimport Ds6 from './piano/Ds6.wav';\nimport E0 from './piano/E0.wav';\nimport E1 from './piano/E1.wav';\nimport E2 from './piano/E2.wav';\nimport E3 from './piano/E3.wav';\nimport E4 from './piano/E4.wav';\nimport E5 from './piano/E5.wav';\nimport E6 from './piano/E6.wav';\nimport F0 from './piano/F0.wav';\nimport F1 from './piano/F1.wav';\nimport F2 from './piano/F2.wav';\nimport F3 from './piano/F3.wav';\nimport F4 from './piano/F4.wav';\nimport F5 from './piano/F5.wav';\nimport F6 from './piano/F6.wav';\nimport Fs0 from './piano/Fs0.wav';\nimport Fs1 from './piano/Fs1.wav';\nimport Fs2 from './piano/Fs2.wav';\nimport Fs3 from './piano/Fs3.wav';\nimport Fs4 from './piano/Fs4.wav';\nimport Fs5 from './piano/Fs5.wav';\nimport Fs6 from './piano/Fs6.wav';\nimport G0 from './piano/G0.wav';\nimport G1 from './piano/G1.wav';\nimport G2 from './piano/G2.wav';\nimport G3 from './piano/G3.wav';\nimport G4 from './piano/G4.wav';\nimport G5 from './piano/G5.wav';\nimport G6 from './piano/G6.wav';\nimport Gs0 from './piano/Gs0.wav';\nimport Gs1 from './piano/Gs1.wav';\nimport Gs2 from './piano/Gs2.wav';\nimport Gs3 from './piano/Gs3.wav';\nimport Gs4 from './piano/Gs4.wav';\nimport Gs5 from './piano/Gs5.wav';\nimport Gs6 from './piano/Gs6.wav';\n\nconst mapPitch = {\nA0 ,\nA1 ,\nA2 ,\nA3 ,\nA4 ,\nA5 ,\nA6 ,\n'A#0':As0,\n'A#1':As1,\n'A#2':As2,\n'A#3':As3,\n'A#4':As4,\n'A#5':As5,\n'A#6':As6,\nB0 ,\nB1 ,\nB2 ,\nB3 ,\nB4 ,\nB5 ,\nB6 ,\nC0 ,\nC1 ,\nC2 ,\nC3 ,\nC4 ,\nC5 ,\nC6 ,\n'C#0':Cs0,\n'C#1':Cs1,\n'C#2':Cs2,\n'C#3':Cs3,\n'C#4':Cs4,\n'C#5':Cs5,\n'C#6':Cs6,\nD0 ,\nD1 ,\nD2 ,\nD3 ,\nD4 ,\nD5 ,\nD6 ,\n'D#0':Ds0,\n'D#1':Ds1,\n'D#2':Ds2,\n'D#3':Ds3,\n'D#4':Ds4,\n'D#5':Ds5,\n'D#6':Ds6,\nE0 ,\nE1 ,\nE2 ,\nE3 ,\nE4 ,\nE5 ,\nE6 ,\nF0 ,\nF1 ,\nF2 ,\nF3 ,\nF4 ,\nF5 ,\nF6 ,\n'F#0':Fs0,\n'F#1':Fs1,\n'F#2':Fs2,\n'F#3':Fs3,\n'F#4':Fs4,\n'F#5':Fs5,\n'F#6':Fs6,\nG0 ,\nG1 ,\nG2 ,\nG3 ,\nG4 ,\nG5 ,\nG6 ,\n'G#0':Gs0,\n'G#1':Gs1,\n'G#2':Gs2,\n'G#3':Gs3,\n'G#4':Gs4,\n'G#5':Gs5,\n'G#6':Gs6,\n    }\nexport default mapPitch;","//音高演算法\nconst Amdf = (config = {}) => {\n  const DEFAULT_MIN_FREQUENCY = 82;\n  const DEFAULT_MAX_FREQUENCY = 1000;\n  const DEFAULT_RATIO = 5;\n  const DEFAULT_SENSITIVITY = 0.1;\n  const DEFAULT_SAMPLE_RATE = 44100;\n\n  const sampleRate = config.sampleRate || DEFAULT_SAMPLE_RATE;\n  const minFrequency = config.minFrequency || DEFAULT_MIN_FREQUENCY;\n  const maxFrequency = config.maxFrequency || DEFAULT_MAX_FREQUENCY;\n  const sensitivity = config.sensitivity || DEFAULT_SENSITIVITY;\n  const ratio = config.ratio || DEFAULT_RATIO;\n  const amd = [];\n\n  /* Round in such a way that both exact minPeriod as \n     exact maxPeriod lie inside the rounded span minPeriod-maxPeriod,\n     thus ensuring that minFrequency and maxFrequency can be found\n     even in edge cases */\n  const maxPeriod = Math.ceil(sampleRate / minFrequency);\n  const minPeriod = Math.floor(sampleRate / maxFrequency);\n\n  return function AMDFDetector(float32AudioBuffer) {\n    const maxShift = float32AudioBuffer.length;\n\n    let t = 0;\n    let minval = Infinity;\n    let maxval = -Infinity;\n    let frames1, frames2, calcSub, i, j, u, aux1, aux2;\n\n    // Find the average magnitude difference for each possible period offset.\n    for (i = 0; i < maxShift; i++) {\n      if (minPeriod <= i && i <= maxPeriod) {\n        for (\n          aux1 = 0, aux2 = i, t = 0, frames1 = [], frames2 = [];\n          aux1 < maxShift - i;\n          t++, aux2++, aux1++\n        ) {\n          frames1[t] = float32AudioBuffer[aux1];\n          frames2[t] = float32AudioBuffer[aux2];\n        }\n\n        // Take the difference between these frames.\n        const frameLength = frames1.length;\n        calcSub = [];\n        for (u = 0; u < frameLength; u++) {\n          calcSub[u] = frames1[u] - frames2[u];\n        }\n\n        // Sum the differences.\n        let summation = 0;\n        for (u = 0; u < frameLength; u++) {\n          summation += Math.abs(calcSub[u]);\n        }\n        amd[i] = summation;\n      }\n    }\n\n    for (j = minPeriod; j < maxPeriod; j++) {\n      if (amd[j] < minval) minval = amd[j];\n      if (amd[j] > maxval) maxval = amd[j];\n    }\n\n    const cutoff = Math.round(sensitivity * (maxval - minval) + minval);\n    for (j = minPeriod; j <= maxPeriod && amd[j] > cutoff; j++);\n\n    const search_length = minPeriod / 2;\n    minval = amd[j];\n    let minpos = j;\n    for (i = j - 1; i < j + search_length && i <= maxPeriod; i++) {\n      if (amd[i] < minval) {\n        minval = amd[i];\n        minpos = i;\n      }\n    }\n\n    if (Math.round(amd[minpos] * ratio) < maxval) {\n      return sampleRate / minpos;\n    } else {\n      return null;\n    }\n  };\n};\n\nexport default Amdf;\n","//取眾數\nconst getMode = arr => {\n  let countList = {};\n  for (let value of arr) {\n    value = value.toString();\n    if (!countList[value]) countList[value] = 0;\n    countList[value]++;\n  }\n  let maxCount = 0;\n  let mode = [];\n  for (let prop in countList) {\n    if (maxCount < countList[prop]) {\n      maxCount = countList[prop];\n      mode = [prop];\n    } else if (maxCount === countList[prop]) {\n      mode.push(prop);\n    }\n  }\n  //如果抓到兩個眾數只回傳第一個\n  return mode[0];\n};\n\nconst noteStrings = [\n  \"C\",\n  \"C#\",\n  \"D\",\n  \"D#\",\n  \"E\",\n  \"F\",\n  \"F#\",\n  \"G\",\n  \"G#\",\n  \"A\",\n  \"A#\",\n  \"B\"\n];\nconst scaleStrings = [\n  \"低低低低低音\",\n  \"低低低低音\",\n  \"低低低音\",\n  \"1\",\n  \"2\",\n  \"3\",\n  \"4\",\n  \"5\",\n  \"高高高音\",\n  \"高高高高音\",\n  \"高高高高高音\"\n];\n// const noteStrings = [\n//   \"Do\",\n//   \"Do#\",\n//   \"Re\",\n//   \"Re#\",\n//   \"Mi\",\n//   \"Fa\",\n//   \"Fa#\",\n//   \"So\",\n//   \"So#\",\n//   \"La\",\n//   \"La#\",\n//   \"Si\"\n// ];\n\nconst noteFromPitch = frequency => {\n  var noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n  return Math.round(noteNum) + 69;\n};\nconst noteFromPitchForCanvas = frequency => {\n  var noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n  return noteNum + 69;\n};\n\nconst frequencyFromNoteNumber = note => {\n  return 440 * Math.pow(2, (note - 69) / 12);\n};\n\nconst centsOffFromPitch = (frequency, note) => {\n  return Math.floor(\n    (1200 * Math.log(frequency / frequencyFromNoteNumber(note))) / Math.log(2)\n  );\n};\n\nconst keyFromNote = note => {\n  if(note>0 && note<10000)\n  return noteStrings[note % 12] + scaleStrings[Math.floor(note / 12)];\n  else return null\n};\n\nconst getUserMedia = (dictionary, callback, handleError) => {\n  try {\n    navigator.getUserMedia =\n      navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia;\n    navigator.getUserMedia(dictionary, callback, handleError);\n  } catch (e) {\n    alert(\"getUserMedia threw exception :\" + e);\n  }\n};\n\nexport {\n  keyFromNote,\n  centsOffFromPitch,\n  frequencyFromNoteNumber,\n  noteFromPitchForCanvas,\n  noteFromPitch,\n  getMode,\n  getUserMedia\n};\n","import React, { useMemo, useState, useRef } from \"react\";\nimport mapPitch from \"./mapPitch.js\";\nimport Amdf from \"./amdfDetector.js\";\nimport * as util from \"./pitch.util\";\nimport Tone from \"tone\";\nimport ml5 from \"ml5\";\n// import MIDI from \"@tonejs/midi\";\n\nconst model_url =\n  \"https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models/models/pitch-detection/crepe/\";\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.msRequestAnimationFrame;\n\nconst cancelAnimationFrame =\n  window.cancelAnimationFrame || window.mozCancelAnimationFrame;\n\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\n\nconst synth = new Tone.Sampler(mapPitch, function() {\n  console.log(\"ok\");\n}).toMaster();\n\nconst PitchDetector = props => {\n  const [pitch, setPitch] = useState(\"-\");\n  const pitch2 = useRef(null);\n  const tempPitch2 = useRef(\"-\");\n  const [, forceUpdate] = useState(null);\n  const [note, setNote] = useState(\"-\");\n  const [isRecord, setIsRecord] = useState(false);\n  const isCatchVoice = useRef(false);\n  const allVoice = useRef({});\n  const allVoiceArray = useRef([]);\n  const audioContext = useRef(new AudioContext());\n  const analyser = useRef(null);\n  const rafID = useRef(null);\n  const buf = useRef(new Float32Array(1024));\n  const AMDFDetector = useMemo(Amdf, []);\n\n  const toggleLiveInput = () => {\n    if (rafID.current !== null) {\n      if (isRecord) {\n        cancelAnimationFrame(rafID.current);\n        setIsRecord(false);\n      } else {\n        updatePitch();\n        setIsRecord(true);\n      }\n    } else {\n      const dictionarySetting = {\n        audio: {\n          mandatory: {\n            // googEchoCancellation: \"false\",\n            // googAutoGainControl: \"false\",\n            // googNoiseSuppression: \"false\",\n            // googHighpassFilter: \"false\"\n            googEchoCancellation: true,\n            googAutoGainControl: true,\n            googNoiseSuppression: true,\n            googHighpassFilter: true,\n            googNoiseSuppression2: true,\n            googEchoCancellation2: true,\n            googAutoGainControl2: true\n          },\n          optional: []\n        }\n      };\n      const gotStream = stream => {\n        const mediaStreamSource = audioContext.current.createMediaStreamSource(\n          stream\n        );\n\n        /////第二種方法測試\n        pitch2.current = ml5.pitchDetection(\n          model_url,\n          audioContext.current,\n          stream,\n          () => {\n            console.log(\"okkk\");\n          }\n        );\n\n        analyser.current = audioContext.current.createAnalyser();\n        mediaStreamSource.connect(analyser.current);\n        setIsRecord(true);\n        updatePitch();\n        console.log(123);\n      };\n      const handleError = () => {\n        alert(\"getUserMedia失敗\");\n      };\n      util.getUserMedia(dictionarySetting, gotStream, handleError);\n    }\n  };\n\n  const toggleCatchVoice = () => {\n    if (isCatchVoice.current) {\n      playTheCatchVoice(allVoiceArray.current);\n      allVoice.current = {};\n      allVoiceArray.current = [];\n      isCatchVoice.current = false;\n      setNote(\",\");\n    } else {\n      isCatchVoice.current = true;\n      setNote(\".\");\n    }\n  };\n\n  const playTheCatchVoice = catchedVoice => {\n    let voiceCat = [];\n    let allowWrongLimit = 6;\n\n    for (var i = 0; i < catchedVoice.length; i++) {\n      let diffPitchCount = 0;\n      for (var j = i + 1; j < catchedVoice.length; j++) {\n        if (catchedVoice[i].pitch !== catchedVoice[j].pitch) {\n          diffPitchCount++;\n        }\n        if (diffPitchCount >= allowWrongLimit) break;\n      }\n\n      let targetPitchNumber =\n        j - diffPitchCount <= catchedVoice.length - 1\n          ? j - diffPitchCount\n          : catchedVoice.length - 1;\n\n      //一個音持續了多久\n      let PitchKeepSecond =\n        (catchedVoice[targetPitchNumber].time - catchedVoice[i].time) / 1000;\n\n      voiceCat.push({\n        pitch: catchedVoice[i].pitch,\n        sec: PitchKeepSecond,\n        count: targetPitchNumber - i\n      });\n\n      i = targetPitchNumber;\n    }\n    const newCat = [];\n    let prevCount = 0;\n    voiceCat.forEach((v, i) => {\n      if (v.count < allowWrongLimit) {\n        prevCount++;\n        if (i - prevCount > 0) {\n          newCat[i - prevCount].sec += v.sec;\n          newCat[i - prevCount].count += v.count;\n        }\n      } else {\n        newCat.push({ pitch: v.pitch, sec: v.sec, count: v.count });\n      }\n    });\n    console.log(newCat);\n\n    let allTime = 0;\n    const now = Tone.now() + 1;\n    newCat.forEach((v, i) => {\n      synth.triggerAttackRelease(v.pitch, v.sec, allTime + now);\n      allTime += v.sec;\n    });\n  };\n\n  const updatePitch = () => {\n    analyser.current.getFloatTimeDomainData(buf.current);\n    const ac = AMDFDetector(buf.current);\n    const myNote = util.noteFromPitch(ac) + 12; //13;\n    const myPitch = util.keyFromNote(myNote);\n    const isPersonVoice = myNote < 36 || myNote > 95; //假設人聲發不出高高高 低低低的聲音 如有感測到 就過濾掉\n\n    if (isPersonVoice) {\n      setNote(\"-\");\n      setPitch(\"-\");\n    } else {\n      setNote(myNote);\n      setPitch(myPitch);\n\n      if (isCatchVoice.current) {\n        allVoiceArray.current.push({\n          pitch: myPitch,\n          time: new Date().getTime()\n        });\n        allVoice.current[myPitch] = !!allVoice.current[myPitch]\n          ? allVoice.current[myPitch] + 1\n          : 1;\n      }\n    }\n\n    rafID.current = requestAnimationFrame(updatePitch);\n\n    pitch2.current.getPitch((error, frequency) => {\n      if (error) {\n        console.error(error);\n      } else {\n        // const ac = AMDFDetector(buf.current);\n        // const myNote = util.noteFromPitch(ac);// + 13;\n        // const myPitch = util.keyFromNote(myNote);\n        const myNote2 = util.noteFromPitch(frequency) + 12; // + 13;\n        const myPitch2 = util.keyFromNote(myNote2);\n        if (myPitch2 !== null) {\n          tempPitch2.current = myPitch2;\n        } else {\n          tempPitch2.current = \"-\";\n        }\n      }\n      forceUpdate();\n    });\n  };\n\n  const openMicStyle = useMemo(\n    () => ({\n      display: \"inline-block\",\n      cursor: \"pointer\",\n      border: \"solid 2px #eee\",\n      borderRadius: \"4px\",\n      padding: \"4px 8px\"\n    }),\n    []\n  );\n\n  const openCatchStyle = useMemo(\n    () => ({\n      display: \"inline-block\",\n      cursor: \"pointer\",\n      border: \"solid 2px #eee\",\n      borderRadius: \"4px\",\n      padding: \"4px 8px\",\n      marginTop: \"8px\"\n    }),\n    []\n  );\n  return (\n    <>\n      <div onClick={toggleLiveInput} style={openMicStyle}>\n        {isRecord ? \"關閉麥克風\" : \"開啟麥克風\"}\n      </div>\n      <div onClick={toggleCatchVoice} style={openCatchStyle}>\n        {isCatchVoice.current ? \"  演奏  \" : \"人聲轉樂器錄製\"}\n      </div>\n      <div>isRecord:{isRecord ? \"TRUE\" : \"FALSE\"}</div>\n      <div>isCatchVoice:{isCatchVoice.current ? \"TRUE\" : \"FALSE\"}</div>\n      <div>note:{note}</div>\n      <div>硬用算式算的pitch:{pitch}</div>\n      <div>人工智慧算的pitch:{tempPitch2.current}</div>\n    </>\n  );\n};\n\nexport default PitchDetector;\n","import React from \"react\";\nimport logo from \"./logo.svg\";\nimport MIDI from \"@tonejs/midi\";\nimport Tone from \"tone\";\nimport \"./App.css\";\nimport kissTheRain from './music/lemon.mid';\nimport PitchDetector from \"./components/PitchDetector/PitchDetector\";\nimport mapPitch from \"./components/PitchDetector/mapPitch\";\n\nfunction App() {\n  const [myMidi, setMyMidi] = React.useState(null);\n  React.useEffect(() => {\n    MIDI.fromUrl(kissTheRain).then(x => {\n      setMyMidi(x);\n      console.log('okk')\n    });\n  }, []);\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <PitchDetector />\n      </header>\n      <button\n        onClick={() => {\n          console.log(myMidi);\n          const now = Tone.now() + 1.5;\n          console.log(now);\n          myMidi.tracks.forEach(track => {\n            let synth = null;\n            new Promise(solve => {\n              synth = new Tone.Sampler(mapPitch, function() {\n                solve();\n              }).toMaster();\n            }).then(() => {\n              track.notes.forEach(note => {\n                synth.triggerAttackRelease(\n                  note.name,\n                  note.duration,\n                  note.time + now,\n                  note.velocity\n                );\n              });\n            });\n          });\n        }}\n        type=\"button\"\n      >\n        Start\n      </button>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}